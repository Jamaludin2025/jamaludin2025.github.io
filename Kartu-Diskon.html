<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kartu Undian Diskon</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      background: linear-gradient(to right, #e0f7fa, #ffffff);
      padding: 20px;
    }
    h1 {
      color: #00796b;
      font-size: 1.4rem;
    }
    h2 {
      color: #00796b;
      font-size: 1rem;
    }
    .cards {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 20px;
      gap: 20px;
    }
    .card {
      width: 100px;
      height: 140px;
      background: #009688;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      cursor: pointer;
      transition: transform 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 18px;
    }
    .card:hover {
      transform: scale(1.05);
    }
    .revealed {
      background: #ffffff;
      color: #333;
      font-size: 16px;
      flex-direction: column;
    }
    .revealed span {
      font-size: 22px;
      font-weight: bold;
      color: #d32f2f;
      margin-top: 5px;
    }
    .disabled {
      pointer-events: none;
      opacity: 0.6;
    }
    .result-box {
      margin-top: 30px;
      padding: 15px;
      border-radius: 10px;
      background-color: #fff3e0;
      display: inline-block;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>

  <h1>üéÅ Kupon Diskon Menarik üéÅ</h1>
  <h2>Pilihlah salah satu kartu dengan cermat, <br> karena kesempatan hanya diberikan satu kali.</h2>

  <div id="cards" class="cards"></div>

  <div id="result" class="result-box" style="display:none;"></div>

  <script>
  const isAdmin = new URLSearchParams(window.location.search).has("admin");
  const alreadyPlayed = !isAdmin && localStorage.getItem("sudahMain");
  const cardsContainer = document.getElementById("cards");
  const resultBox = document.getElementById("result");

  const diskonOptions = [
    { label: "5%", kode: "BLU5ZX", weight: 50 },
    { label: "15%", kode: "GRN15SP", weight: 10 },
    { label: "25%", kode: "RED25AK", weight: 8 },
    { label: "35%", kode: "ORG35MQ", weight: 7 },
    { label: "50%", kode: "GLD50LU", weight: 5 }
  ];

  function weightedRandom(options) {
    const totalWeight = options.reduce((sum, opt) => sum + opt.weight, 0);
    let random = Math.random() * totalWeight;
    for (let opt of options) {
      if (random < opt.weight) return opt;
      random -= opt.weight;
    }
  }

  function revealAllCards(clickedCard, rewardMap) {
    const allCards = document.querySelectorAll(".card");
    allCards.forEach((card, index) => {
      const reward = rewardMap[index];
      card.classList.add("revealed");
      card.innerHTML = `
        <div>Diskon</div>
        <span>${reward.label}</span>
      `;
      card.classList.add("disabled");
    });

    const clickedIndex = [...allCards].indexOf(clickedCard);
    const reward = rewardMap[clickedIndex];

    resultBox.style.display = "block";
    resultBox.innerHTML = `üéâ Kamu mendapatkan diskon <strong>${reward.label}</strong><br>
    Gunakan kode: <strong>${reward.kode}</strong> saat checkout!`;

    if (!isAdmin) localStorage.setItem("sudahMain", "true");
  }

  function setupCards() {
    const rewardMap = Array.from({ length: 5 }, () => weightedRandom(diskonOptions));

    for (let i = 0; i < 5; i++) {
      const card = document.createElement("div");
      card.className = "card";
      card.textContent = "PILIH";
      card.addEventListener("click", () => {
        if (document.querySelector(".revealed")) return; // satu kali klik
        revealAllCards(card, rewardMap);
      });
      cardsContainer.appendChild(card);
    }
  }

  if (alreadyPlayed) {
    cardsContainer.innerHTML = "<p><strong>Kamu sudah menggunakan kesempatan.<br>Coba lagi di lain waktu.</strong></p>";
  } else {
    setupCards();
  }
</script>

</body>
</html>
